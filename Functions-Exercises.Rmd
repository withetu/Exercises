---
title: "R Notebook"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Ctrl+Shift+Enter*. 

```{r}
#http://r-exercises.com/2016/02/07/functions-exercises/



#Create a function that will return the sum of 2 integers
f.sum<- function(x,y){
  r<- x+y
  r
}
f.sum(5,10)

#Create a function that will return TRUE if a given integer is inside a vector
f.exists<-function(v,x){
  exist<- FALSE
  i<-1
  
  while(i<=length(v) & !exist){
    
    if(v[i]==x){
      exist<- TRUE
    }
      i<- i+1
  }
    exist
}
f.exists(c(1:10),10)
f.exists(c(9,3,1),10)

#Create a function that given a data frame will print by screen the name of the column and the class of data it contains (e.g. Variable1 is Numeric).
f.class<- function(df)
{
  for(i in 1:ncol(df))
  {
    cat(names(df)[i], "is", class(df[,i]), "\n")
  }
}
f.class(cars)

#Create the function unique, which given a vector will return a new vector with the elements of the first vector with duplicated elements removed
f.uniq<- function(v)
{
  s<-c()
  
  for (i in 1:length(v))
  {
    if(sum(v[i]==s)==0)
    {
      s<- c(s, v[i])
    }
  }
  s
}
f.uniq(c(9,9,1,1,1,0,3,2,3,4))

#Create a function that given a vector and an integer will return how many times the integer appears inside the vector
f.count<- function(v,x)
{
  count<- 0
  
  for(i in 1:length(v))
  {
    if(v[i]==x)
    {
      count<- count+1
    }
  }
  count
}
f.count(c(1:9, rep(10,100)), 10)

#Create a function that given a vector will print by screen the mean and the standard deviation, it will optionally also print the median.
desi<- function(x, med=FALSE)
{
  mean<- round(mean(x),1)
  stdv<- round(sd(x),1)
  cat("Mean is: ", mean, ", SD is: ", stdv, "\n")
  
  if(med)
  {
    median<-median(x)
    cat("Median is: ", median, "\n")
  }
}
desi(1:10, med = TRUE)

#Create a function that given an integer will calculate how many divisors it has (other than 1 and itself). Make the divisors appear by screen.
f.div<- function(n)
{
  i<-2
  counter<-0
  
  while(i <=n/2)
  {
    if(n%%i==0)
    {
      counter<- counter+1
      cat(i, "\n")
    }
    i<-i+1
  }
  counter
}
f.div(13)
f.div(16)
f.div(20)

#Create a function that given a data frame, and a number or character will return the data frame with the character or number changed to NA.
f.na<- function(df, otherna)
{
  for(i in 1:ncol(df))
  {
    for(j in 1:nrow(df))
    {
      if(df[j,i]==otherna)
      {
        df[j,i]<-NA
      }
    }
  }
  df
}
carsnew<- f.na(cars,10)
carsnew




#http://r-exercises.com/2016/12/05/functions-exercises-vol-2/
#                  Functions exercises vol. 2


# Create a function that given a data frame and a vector, will add a the vector (if the vector length match with the rows number of the data frame) as a new variable to the data frame.
ID=rep(c(1,2,3,4), each=3)
Letter=rep(letters[1:3],4)
x=seq(1,43, along.with = ID)
y=seq(-20,0, along.with = ID)
M=data.frame(ID, Letter, x,y)

ADD_COL=function(M,v)
{
  if(nrow(M)==length(v))
    M=cbind(M,v)
  return(M)
}

z=seq(1,100,along.with = ID)
M=ADD_COL(M,z)

u=c(1:10)
M=ADD_COL(M,u)

w=seq(0,20, along.with = ID)
M=ADD_COL(M,w)

M

#Consider a data frame df:
Id=c(1:10)
Age=c(14,12,15,10,23,21,41,56,78,12)
Sex=c('F','M','M','F','M','F','M','M','F','M')
Code=letters[1:10]
df=data.frame(Id,Age,Sex,Code)
#Create a function that, given a data frame and two indexes, exchanges two values of the Code variable with each other. 
#For example, if the index is 1 and 3, you assign:#df[1,'Code']=df[3,'Code']
#df[3,'Code']=df[1,'Code']
change=function(df,a,b)
{
  aux=df[a,'Code']
  df[a,'Code']=df[b,'Code']
  df[b,'Code']=aux
  return(df)
}

df=change(df,1,3)
df=change(df,7,2)
df=change(df,5,10)
df

#Consider two variables x,y and a data frame df:
#x,y integer
A=c(1:10)
B=seq(100,10,-10)
H=seq(-200,-50,along.with = B)
df=data.frame(A,B,H)
df
#Create a function that given a data frame df calculate a new variable ‘SUM_x_y'(If x=2 and y=3, then the new variable will be ‘SUM_2_3’,
#if x=4 and y=10, then the new variable will be ‘SUM_4_10’),such that for each row ‘i’ is equal to:
#sum(x*df[1:i,1])+sum(y*df[1:i,2])
NEWDF=function(df,x,y)
{
  for(i in 1:nrow(df))
    df[i,4]=sum(x*df[1:i,1])+sum(y*df[1:i,2])
  names(df)[4]=paste('SUM',x,y,sep='_')
  df
}
NEWDF(df,3,6)
NEWDF(df,7,5)


```

Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Ctrl+Alt+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Ctrl+Shift+K* to preview the HTML file).

